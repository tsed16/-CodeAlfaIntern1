<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Responsive Image Gallery</title>
<style>
    :root{
        --bg:#0f1724; --card:#0b1220; --accent:#06b6d4; --text:#e6eef8;
        --gap:12px; --radius:8px;
    }
    *{box-sizing:border-box}
    body{
        margin:0; font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
        background:linear-gradient(180deg,#071028 0%, #08132a 100%); color:var(--text);
        padding:28px;
    }

    header{
        display:flex; gap:12px; align-items:center; justify-content:space-between;
        margin-bottom:18px;
    }
    h1{font-size:18px;margin:0}
    .controls{
        display:flex; gap:8px; align-items:center; flex-wrap:wrap;
    }

    .btn{
        background:linear-gradient(180deg,#0e1820,#06111a); color:var(--text);
        border:1px solid rgba(255,255,255,0.04); padding:8px 12px; border-radius:999px;
        cursor:pointer; font-size:13px;
        transition:transform .15s ease, box-shadow .15s;
    }
    .btn:hover{transform:translateY(-3px); box-shadow:0 6px 18px rgba(4,6,12,.6)}
    .btn.active{outline:2px solid rgba(6,182,212,.12); box-shadow:0 6px 30px rgba(6,182,212,.06)}
    .filter-select{
        padding:8px 10px; background:transparent; color:var(--text); border-radius:8px;
        border:1px solid rgba(255,255,255,.04);
    }

    /* Gallery grid */
    .gallery{
        display:grid; gap:var(--gap);
        grid-template-columns:repeat(auto-fit, minmax(160px, 1fr));
    }
    .card{
        position:relative; overflow:hidden; border-radius:var(--radius);
        background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.16));
        cursor:zoom-in; transition:transform .35s cubic-bezier(.2,.9,.2,1), box-shadow .3s;
        border:1px solid rgba(255,255,255,0.03);
    }
    .card:hover{transform:translateY(-6px) scale(1.02); box-shadow:0 20px 40px rgba(2,6,23,.6)}

    .thumb{
        display:block; width:100%; height:0; padding-bottom:66.66%; /* 3:2 */
        background-position:center center; background-size:cover; transition:transform .5s ease;
    }
    .card:hover .thumb{transform:scale(1.08)}

    .meta{
        position:absolute; left:0; right:0; bottom:0; padding:10px;
        background:linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,0.6) 60%);
        color:var(--text); display:flex; align-items:center; justify-content:space-between;
        gap:8px;
    }
    .title{font-size:13px; font-weight:600}
    .tag{
        font-size:11px; padding:4px 8px; border-radius:999px; background:rgba(255,255,255,0.05);
        color: #cfeff6;
    }

    /* Lightbox */
    .lightbox{
        position:fixed; inset:0; display:none; place-items:center; z-index:60;
        background:linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.85));
    }
    .lightbox.open{display:grid}
    .lightbox .panel{
        max-width:1100px; width:95%; max-height:92vh; border-radius:10px; overflow:hidden;
        background:linear-gradient(180deg,#071428,#0b1b2a); box-shadow:0 30px 80px rgba(2,6,23,.8);
        position:relative;
        transform:translateY(18px) scale(.98); opacity:0; transition:transform .28s cubic-bezier(.2,.9,.2,1), opacity .22s;
    }
    .lightbox.open .panel{transform:none; opacity:1}
    .panel img{
        width:100%; height:auto; display:block; max-height:78vh; object-fit:contain; background:#010912;
    }
    .lb-controls{
        position:absolute; inset:auto 12px 12px 12px; display:flex; justify-content:space-between; gap:8px;
    }
    .lb-controls .left{display:flex; gap:8px;}
    .lb-btn{
        background:rgba(6,10,14,0.45); border:1px solid rgba(255,255,255,0.04);
        color:var(--text); padding:8px 10px; border-radius:8px; cursor:pointer;
    }
    .lb-caption{
        padding:10px 12px; font-size:14px; color: #dbeffd; display:flex; justify-content:space-between; align-items:center;
        gap:8px;
    }

    /* small screens */
    @media (max-width:520px){
        .thumb{padding-bottom:75%}
        .meta{padding:8px}
        .lb-controls{inset:auto 8px 8px 8px}
    }
</style>
</head>
<body>
<header>
    <h1>Image Gallery</h1>
    <div class="controls">
        <div id="categoryBtns" aria-label="categories"></div>
        <select id="filterSelect" class="filter-select" title="Image filter">
            <option value="none">Filter: None</option>
            <option value="grayscale(100%)">Grayscale</option>
            <option value="sepia(70%)">Sepia</option>
            <option value="saturate(160%)">Saturate</option>
            <option value="contrast(120%)">Contrast</option>
        </select>
        <button id="resetBtn" class="btn" title="Reset filters & categories">Reset</button>
    </div>
</header>

<main>
    <div id="gallery" class="gallery" aria-live="polite"></div>
</main>

<!-- Lightbox -->
<div id="lightbox" class="lightbox" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="panel" role="document">
        <img id="lbImage" alt="" />
        <div class="lb-caption">
            <div id="lbTitle"></div>
            <div id="lbTag" class="tag" style="font-size:12px"></div>
        </div>
        <div class="lb-controls">
            <div class="left">
                <button id="prevBtn" class="lb-btn" aria-label="Previous (Left Arrow)">Prev</button>
                <button id="nextBtn" class="lb-btn" aria-label="Next (Right Arrow)">Next</button>
            </div>
            <div class="right">
                <button id="closeBtn" class="lb-btn" aria-label="Close (Esc)">Close</button>
            </div>
        </div>
    </div>
</div>

<script>
/* GitHub Copilot */
(() => {
    // Images: use picsum.photos for stable IDs and sizes
    const images = [
        {id:1015, title:"Misty Mountains", category:"Nature"},
        {id:1025, title:"City Harbor", category:"Cities"},
        {id:1005, title:"Desert Dunes", category:"Nature"},
        {id:1011, title:"Street Portrait", category:"People"},
        {id:1018, title:"Forest Stream", category:"Nature"},
        {id:1031, title:"Downtown Lights", category:"Cities"},
        {id:1003, title:"Portrait Close-up", category:"People"},
        {id:1043, title:"Coastal View", category:"Nature"},
        {id:1050, title:"Urban Alley", category:"Cities"}
    ];

    const gallery = document.getElementById('gallery');
    const categoryBtns = document.getElementById('categoryBtns');
    const filterSelect = document.getElementById('filterSelect');
    const resetBtn = document.getElementById('resetBtn');

    // Build category buttons
    const categories = ["All", ...Array.from(new Set(images.map(i => i.category)))];
    categories.forEach(cat => {
        const b = document.createElement('button');
        b.className = 'btn' + (cat === 'All' ? ' active' : '');
        b.textContent = cat;
        b.dataset.cat = cat;
        b.addEventListener('click', () => {
            document.querySelectorAll('#categoryBtns .btn').forEach(x => x.classList.remove('active'));
            b.classList.add('active');
            applyFilters();
        });
        categoryBtns.appendChild(b);
    });

    // Build gallery items
    function makeThumbUrl(id, w=600, h=400){ return `https://picsum.photos/id/${id}/${w}/${h}`; }
    images.forEach((img, idx) => {
        const a = document.createElement('div');
        a.className = 'card';
        a.tabIndex = 0;
        a.dataset.index = idx;
        a.dataset.cat = img.category;
        a.innerHTML = `
            <div class="thumb" style="background-image:url('${makeThumbUrl(img.id,800,533)}')" role="img" aria-label="${img.title}"></div>
            <div class="meta">
                <div class="title">${img.title}</div>
                <div class="tag">${img.category}</div>
            </div>
        `;
        // click & keyboard open
        a.addEventListener('click', () => openLightbox(idx));
        a.addEventListener('keydown', (e) => { if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openLightbox(idx); } });
        gallery.appendChild(a);
    });

    // Apply category and CSS filter
    function applyFilters(){
        const activeCat = document.querySelector('#categoryBtns .btn.active').dataset.cat;
        const filter = filterSelect.value;
        document.querySelectorAll('.card').forEach(card => {
            card.style.display = (activeCat === 'All' || card.dataset.cat === activeCat) ? '' : 'none';
            card.querySelector('.thumb').style.filter = filter;
        });
    }

    filterSelect.addEventListener('change', applyFilters);
    resetBtn.addEventListener('click', () => {
        document.querySelector('#categoryBtns .btn.active').classList.remove('active');
        document.querySelector('#categoryBtns .btn').classList.add('active'); // set first (All)
        filterSelect.value = 'none';
        applyFilters();
    });

    // LIGHTBOX
    const lightbox = document.getElementById('lightbox');
    const lbImage = document.getElementById('lbImage');
    const lbTitle = document.getElementById('lbTitle');
    const lbTag = document.getElementById('lbTag');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const closeBtn = document.getElementById('closeBtn');

    let currentIndex = 0;

    function openLightbox(index){
        currentIndex = index;
        const obj = images[currentIndex];
        lbImage.src = makeThumbUrl(obj.id, 1600, 1066);
        lbImage.alt = obj.title;
        lbTitle.textContent = obj.title;
        lbTag.textContent = obj.category;
        // Apply same filter as thumbnails
        lbImage.style.filter = filterSelect.value;
        lightbox.classList.add('open');
        lightbox.setAttribute('aria-hidden', 'false');
        document.body.style.overflow = 'hidden';
        // focus for keyboard
        closeBtn.focus();
    }

    function closeLightbox(){
        lightbox.classList.remove('open'); 
        lightbox.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
    }

    function showNext(offset=1){
        currentIndex = (currentIndex + offset + images.length) % images.length;
        // skip hidden images if filtered by category
        const activeCat = document.querySelector('#categoryBtns .btn.active').dataset.cat;
        let tries = 0;
        while(activeCat !== 'All' && images[currentIndex].category !== activeCat && tries < images.length){
            currentIndex = (currentIndex + offset + images.length) % images.length;
            tries++;
        }
        openLightbox(currentIndex);
    }

    prevBtn.addEventListener('click', () => showNext(-1));
    nextBtn.addEventListener('click', () => showNext(1));
    closeBtn.addEventListener('click', closeLightbox);
    lightbox.addEventListener('click', (e) => { if(e.target === lightbox) closeLightbox(); });

    // keyboard
    document.addEventListener('keydown', (e) => {
        if(lightbox.classList.contains('open')){
            if(e.key === 'ArrowRight') showNext(1);
            else if(e.key === 'ArrowLeft') showNext(-1);
            else if(e.key === 'Escape') closeLightbox();
        }
    });

    // smooth transitions: preload next/prev
    lbImage.addEventListener('load', () => {
        const next = (currentIndex+1) % images.length;
        const prev = (currentIndex-1+images.length) % images.length;
        const p1 = new Image(); p1.src = makeThumbUrl(images[next].id,1600,1066);
        const p2 = new Image(); p2.src = makeThumbUrl(images[prev].id,1600,1066);
    });

    // initial apply
    applyFilters();
})();
</script>
</body>
</html>
